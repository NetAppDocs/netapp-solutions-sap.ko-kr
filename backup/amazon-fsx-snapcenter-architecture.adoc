---
sidebar: sidebar 
permalink: backup/amazon-fsx-snapcenter-architecture.html 
keywords: snapcenter, scope, data protection strategy, example lab setup 
summary: SnapCenter는 애플리케이션 정합성을 보장하는 데이터 보호를 위한 확장 가능한 유니파이드 플랫폼입니다. SnapCenter는 중앙 집중식 제어 및 감독을 지원하면서 사용자가 애플리케이션별 백업, 복원 및 클론 작업을 관리할 수 있는 기능을 위임합니다. 데이터베이스 및 스토리지 관리자는 SnapCenter를 사용하여 다양한 애플리케이션과 데이터베이스의 백업, 복원, 클론 복제 작업을 관리하는 단일 툴에 대해 알아보십시오. SnapCenter는 NetApp에서 제공하는 Data Fabric의 엔드 포인트 전체에서 데이터를 관리합니다. 
---
= SnapCenter 아키텍처
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


link:amazon-fsx-backup-and-recovery-using-amazon-fsx-for-ontap.html["이전: ONTAP용 Amazon FSx를 사용한 백업 및 복구."]



== SnapCenter 개요

SnapCenter는 애플리케이션 정합성을 보장하는 데이터 보호를 위한 확장 가능한 유니파이드 플랫폼입니다. SnapCenter는 중앙 집중식 제어 및 감독을 지원하면서 사용자가 애플리케이션별 백업, 복원 및 클론 작업을 관리할 수 있는 기능을 위임합니다. 데이터베이스 및 스토리지 관리자는 SnapCenter를 사용하여 다양한 애플리케이션과 데이터베이스의 백업, 복원, 클론 복제 작업을 관리하는 단일 툴에 대해 알아보십시오. SnapCenter는 NetApp에서 제공하는 Data Fabric의 엔드 포인트 전체에서 데이터를 관리합니다. SnapCenter를 사용하여 사내 환경 간에, 사내 환경과 클라우드 간에, 그리고 프라이빗, 하이브리드 또는 퍼블릭 클라우드 간에 데이터를 복제할 수 있습니다.



== SnapCenter 구성 요소

SnapCenter에는 SnapCenter 서버, Windows용 SnapCenter 플러그인 패키지 및 Linux용 SnapCenter 플러그인 패키지가 포함되어 있습니다. 각 패키지에는 다양한 애플리케이션 및 인프라 구성요소를 위한 SnapCenter용 플러그인이 포함되어 있습니다.

image:amazon-fsx-image5.png["오류: 그래픽 이미지가 없습니다"]



== SnapCenter SAP HANA 백업 솔루션

SAP HANA용 SnapCenter 백업 솔루션은 다음과 같은 영역을 다룹니다.

* 백업 작업, 스케줄링 및 보존 관리
+
** 스토리지 기반 Snapshot 복사본으로 SAP HANA 데이터 백업
** 스토리지 기반 Snapshot 복사본으로 데이터를 백업하지 않는 볼륨 백업(예: '/HANA/공유')
** 파일 기반 백업을 사용하여 데이터베이스 블록 무결성 검사
** 오프 사이트 백업 또는 재해 복구 위치로 복제


* SAP HANA 백업 카탈로그 관리
+
** HANA 데이터 백업(스냅샷 및 파일 기반)
** HANA 로그 백업의 경우


* 복원 및 복구 작업
+
** 자동 복원 및 복구
** SAP HANA(MDC) 시스템을 위한 단일 테넌트 복원 작업




데이터베이스 데이터 파일 백업은 SnapCenter에서 SAP HANA용 플러그인과 함께 실행됩니다. 이 플러그인은 운영 스토리지 시스템에 생성된 스냅샷 복사본이 SAP HANA 데이터베이스의 일관된 이미지를 기반으로 생성되도록 SAP HANA 데이터베이스 백업 저장 지점을 트리거합니다.

SnapCenter를 사용하면 SnapVault 또는 SnapMirror 기능을 사용하여 정합성이 보장된 데이터베이스 이미지를 오프 사이트 백업 또는 재해 복구 위치로 복제할 수 있습니다. 일반적으로 기본 및 오프사이트 백업 스토리지의 백업에 대해 서로 다른 보존 정책이 정의됩니다. SnapCenter는 운영 스토리지의 보존을 처리하며, ONTAP는 오프 사이트 백업 스토리지의 보존을 처리합니다.

또한 SnapCenter를 사용하면 모든 SAP HANA 관련 리소스를 완벽하게 백업할 수 있을 뿐만 아니라 스토리지 기반 Snapshot 복사본과 함께 SAP HANA 플러그인을 사용하여 모든 비 데이터 볼륨을 백업할 수 있습니다. 개별 보존 및 보호 정책을 사용할 수 있도록 데이터베이스 데이터 백업과 별도로 비데이터 볼륨을 예약할 수 있습니다.

SAP는 블록 무결성 검사를 실행하기 위해 스토리지 기반 스냅샷 백업을 주간 파일 기반 백업과 결합할 것을 권장합니다. SnapCenter 내에서 블록 무결성 검사를 실행할 수 있습니다. 구성된 보존 정책에 따라 SnapCenter는 운영 스토리지, 로그 파일 백업 및 SAP HANA 백업 카탈로그에서 데이터 파일 백업의 하우스키핑을 관리합니다.

SnapCenter는 운영 스토리지에서 보존을 처리하고, ONTAP용 FSx는 보조 백업 보존을 관리합니다.

다음 그림에서는 SnapCenter 백업 및 보존 관리 작업의 개요를 보여 줍니다.

image:amazon-fsx-image6.png["오류: 그래픽 이미지가 없습니다"]

SAP HANA 데이터베이스의 스토리지 기반 스냅샷 백업을 실행할 때 SnapCenter은 다음과 같은 작업을 수행합니다.

. SAP HANA 백업 세이브 포인트를 생성하여 지속성 계층에서 일관된 이미지를 생성합니다.
. 데이터 볼륨의 스토리지 기반 스냅샷 복사본을 생성합니다.
. 스토리지 기반 Snapshot 백업을 SAP HANA 백업 카탈로그에 등록합니다.
. SAP HANA 백업 저장 지점을 해제합니다.
. 구성된 경우 데이터 볼륨에 대한 SnapVault 또는 SnapMirror 업데이트를 실행합니다.
. 정의된 보존 정책을 기반으로 운영 스토리지에서 스토리지 스냅샷 복사본을 삭제합니다.
. 운영 또는 오프사이트 백업 스토리지에 백업이 더 이상 존재하지 않는 경우 SAP HANA 백업 카탈로그 항목을 삭제합니다.
. 보존 정책에 따라 또는 수동으로 백업을 삭제할 때마다 SnapCenter는 가장 오래된 데이터 백업보다 오래된 모든 로그 백업도 삭제합니다. 로그 백업은 파일 시스템과 SAP HANA 백업 카탈로그에서 삭제됩니다.




== 이 문서의 범위

이 문서에서는 ONTAP용 FSx에서 단일 테넌트가 있는 SAP HANA MDC 단일 호스트 시스템에 대한 가장 일반적인 SnapCenter 구성 옵션에 대해 설명합니다. 다른 구성 옵션도 사용 가능하며, 경우에 따라 다중 호스트 시스템과 같은 특정 SAP HANA 시스템에 필요합니다. 다른 구성 옵션에 대한 자세한 설명은 를 참조하십시오 https://docs.netapp.com/us-en/netapp-solutions-sap/backup/saphana-br-scs-snapcenter-concepts-and-best-practices.html["SnapCenter 개념 및 모범 사례(netapp.com)"^].

이 문서에서는 AWS(Amazon Web Services) 콘솔과 ONTAP CLI용 FSx를 사용하여 스토리지 계층에서 필요한 구성 단계를 실행합니다. NetApp Cloud Manager를 사용하여 ONTAP용 FSx를 관리할 수도 있지만, 이 문서의 범위에 포함되지 않습니다. ONTAP용 FSx용 NetApp Cloud Manager를 사용하는 방법에 대한 자세한 내용은 을 참조하십시오 https://docs.netapp.com/us-en/occm/concept_fsx_aws.html["ONTAP용 Amazon FSx에 대해 자세히 알아보기(netapp.com)"^].



== 데이터 보호 전략

다음 그림은 ONTAP용 FSx에서 SAP HANA를 위한 일반적인 백업 아키텍처를 보여줍니다. HANA 시스템은 AWS 가용성 영역 1에 있으며 동일한 가용성 영역 내에서 ONTAP 파일 시스템용 FSx를 사용합니다. 스냅샷 백업 작업은 HANA 데이터베이스의 데이터와 공유 볼륨에 대해 실행됩니다. 3-5일 동안 유지되는 로컬 스냅샷 백업 외에도 장기 보존을 위해 오프사이트 스토리지에도 백업이 복제됩니다. 오프사이트 백업 스토리지는 다른 AWS 가용성 영역에 있는 ONTAP 파일 시스템용 두 번째 FSx입니다. HANA 데이터 및 공유 볼륨의 백업은 SnapVault를 통해 ONTAP 파일 시스템용 두 번째 FSx로 복제되며 2-3주 동안 유지됩니다.

image:amazon-fsx-image7.png["오류: 그래픽 이미지가 없습니다"]

SnapCenter를 구성하기 전에 다양한 SAP 시스템의 RTO 및 RPO 요구 사항에 따라 데이터 보호 전략을 정의해야 합니다.

일반적인 접근 방식은 운영, 개발, 테스트 또는 샌드박스 시스템과 같은 시스템 유형을 정의하는 것입니다. 동일한 시스템 유형의 모든 SAP 시스템은 일반적으로 동일한 데이터 보호 매개 변수를 사용합니다.

다음 매개 변수를 정의해야 합니다.

* Snapshot 백업을 얼마나 자주 실행해야 합니까?
* Snapshot 복사본 백업을 기본 스토리지 시스템에 얼마나 오래 보관해야 합니까?
* 블록 무결성 검사를 얼마나 자주 실행해야 합니까?
* 기본 백업을 오프 사이트 백업 사이트로 복제해야 합니까?
* 백업을 오프 사이트 백업 스토리지에 얼마나 오래 보관해야 합니까?


다음 표에서는 운영, 개발 및 테스트 등 시스템 유형에 대한 데이터 보호 매개 변수의 예를 보여 줍니다. 운영 시스템의 경우 백업 빈도가 높아지면 백업을 매일 한 번씩 오프사이트 백업 사이트로 복제합니다. 테스트 시스템은 요구 사항이 낮고 백업 복제가 필요하지 않습니다.

|===
| 매개 변수 | 운영 시스템 | 개발 시스템 | 시스템을 테스트합니다 


| 백업 빈도 | 6시간마다 | 6시간마다 | 6시간마다 


| 기본 보존 | 3일 | 3일 | 3일 


| 블록 무결성 검사 | 일주일에 한 번 | 일주일에 한 번 | 아니요 


| 오프 사이트 백업 사이트로 복제 | 하루에 한 번 | 하루에 한 번 | 아니요 


| 오프 사이트 백업 보존 | 2주 | 2주 | 해당 없음 
|===
다음 표에는 데이터 보호 매개 변수에 대해 구성해야 하는 정책이 나와 있습니다.

|===
| 매개 변수 | 정책 LocalSnap | 정책 LocalSnapAndSnapVault입니다 | 정책 블록 통합성 검사 


| 백업 유형 | 스냅샷 기반 | 스냅샷 기반 | 파일 기반 


| 일정 빈도 | 매시간 | 매일 | 매주 


| 기본 보존 | 개수 = 12 | 개수 = 3 | 개수 = 1 


| SnapVault 복제 | 아니요 | 예 | 해당 없음 
|===
LocalSnapshot 정책은 운영, 개발 및 테스트 시스템에 사용되어 2일 동안 로컬 Snapshot 백업을 보존합니다.

리소스 보호 구성에서 스케줄은 시스템 유형에 따라 다르게 정의됩니다.

* 생산: 4시간마다 일정을 예약합니다.
* 개발: 4시간마다 예약.
* 테스트: 4시간마다 예약.


운영 및 개발 시스템에서는 로컬 SnapAndSnapVault 정책을 사용하여 오프사이트 백업 스토리지에 대한 일일 복제를 수행합니다.

리소스 보호 구성에서 일정은 운영 및 개발에 대해 정의됩니다.

* 생산: 매일 일정을 예약합니다.
* 개발: 매일 일정 계획 운영 및 개발 시스템에서는 파일 기반 백업을 사용하여 주간 블록 무결성 검사를 수행하는 BlockIntegrityCheck 정책을 사용합니다.


리소스 보호 구성에서 일정은 운영 및 개발에 대해 정의됩니다.

* 생산: 매주 일정을 예약합니다.
* 개발: 매주 일정을 예약합니다.


오프 사이트 백업 정책을 사용하는 각 개별 SAP HANA 데이터베이스에 대해 스토리지 계층에서 보호 관계를 구성해야 합니다. 보호 관계는 복제할 볼륨과 오프 사이트 백업 스토리지의 백업 보존을 정의합니다.

다음 예에서는 각 운영 및 개발 시스템에 대해 오프사이트 백업 스토리지에서 2주 동안 보존이 정의됩니다.

이 예에서는 SAP HANA 데이터베이스 리소스 및 비 데이터 볼륨 리소스에 대한 보호 정책과 보존 정책이 서로 다릅니다.



== 실습 설정 예

다음 실습 설정은 이 문서의 나머지 부분에 대한 예제 구성으로 사용되었습니다.

HANA 시스템 PFX:

* 단일 테넌트가 있는 단일 호스트 MDC 시스템
* HANA 2.0 SPS 6 개정판 60
* SAP 15SP3용 SLES


SnapCenter:

* 버전 4.6
* HANA 데이터베이스 호스트에 구축된 HANA 및 Linux 플러그인


ONTAP 파일 시스템용 FSX:

* 단일 SVM(Storage Virtual Machine)이 있는 ONTAP 파일 시스템용 FSx 2개
* ONTAP 시스템용 각 FSx는 서로 다른 AWS 가용성 존에 있습니다
* ONTAP 파일 시스템용 두 번째 FSx에 복제된 HANA 데이터 볼륨입니다


image:amazon-fsx-image8.png["오류: 그래픽 이미지가 없습니다"]

link:amazon-fsx-snapcenter-configuration.html["다음: SnapCenter 구성."]
