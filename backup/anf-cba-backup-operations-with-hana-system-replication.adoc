---
sidebar: sidebar 
permalink: backup/anf-cba-backup-operations-with-hana-system-replication.html 
keywords: system replication, cba, hsr, multiple host, standby host 
summary: 이 섹션에서는 HANA 시스템 복제를 사용하여 백업 작업을 수행하는 방법을 설명합니다. 
---
= HANA 시스템 복제를 사용한 백업 작업
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


link:anf-cba-restore-and-recovery-from-snapshot-backup.html["이전: 스냅샷 백업에서 복원 및 복구."]



== 스토리지 스냅샷 백업 및 HANA 시스템 복제

백업 작업에 필요한 SQL 명령은 보조 SAP HANA 호스트에서 수행할 수 없기 때문에 백업 작업은 항상 운영 SAP HANA 호스트에서 수행됩니다.

SAP HANA 백업 작업의 경우 기본 및 보조 SAP HANA 호스트는 단일 엔터티입니다. 이들은 동일한 SAP HANA 백업 카탈로그를 공유하며, 백업이 운영 또는 보조 SAP HANA 호스트에서 생성되었는지에 관계없이 복원 및 복구에 백업을 사용합니다.

복구를 위해 모든 백업을 사용하고 두 호스트에서 로그 백업을 사용하여 복구를 전달하는 기능을 사용하려면 두 호스트에서 액세스할 수 있는 공유 로그 백업 위치가 필요합니다. 공유 스토리지 볼륨을 사용하는 것이 좋습니다. 그러나 로그 백업 대상을 공유 볼륨 내의 하위 디렉토리로도 분리해야 합니다.

각 SAP HANA 호스트에는 자체 스토리지 볼륨이 있습니다. 스토리지 기반 Snapshot을 사용하여 백업을 수행하면 데이터베이스 정합성이 보장되는 Snapshot 복사본이 기본 SAP HANA 호스트의 스토리지 볼륨에 생성됩니다.

image:anf-cba-image102.png["이 그림은 데이터베이스 정합성이 보장되는 Snapshot 복제본이 운영 SAP HANA 호스트의 스토리지 볼륨에 생성되는 방식을 보여 줍니다."]

호스트 2에 대한 페일오버가 수행되면 호스트 2가 운영 SAP HANA 호스트가 되고, 이제 호스트 2에서 백업이 실행되고, 스냅샷 백업이 호스트 2의 스토리지 볼륨에서 생성됩니다.

호스트 2에서 생성된 백업은 스토리지 계층에서 직접 복구할 수 있습니다. 호스트 1에서 생성된 백업을 사용해야 하는 경우 호스트 1 스토리지 볼륨에서 호스트 2 스토리지 볼륨으로 백업을 복제해야 합니다. 정방향 복구는 두 호스트의 로그 백업을 사용합니다.

image:anf-cba-image103.png["이 그림에서는 정방향 복구가 두 호스트의 로그 백업을 사용하는 방법을 보여 줍니다."]



== CBA 및 HSR 지원 HANA 시스템을 사용한 백업 작업

이전 섹션에서 간단히 설명한 것처럼 HSR 지원 HANA 시스템의 백업 작업에는 몇 가지 사항을 고려해야 합니다.

* 백업 작업은 운영 HANA 호스트에서만 실행할 수 있습니다. 따라서 CBA는 백업 작업을 실행할 때 현재 어떤 호스트가 기본 호스트인지 알고 있어야 합니다.
+
** 현재 운영 호스트에 대해 백업 SQL 문을 실행해야 합니다.
** 보조 호스트 데이터 볼륨이 정합성 보장 상태가 아니므로 복구 및 복구 작업에서는 사용할 수 없기 때문에 스냅샷 백업은 운영 호스트 데이터 볼륨에서만 수행해야 합니다.


* Snapshot 백업의 보존 관리는 두 호스트 모두에서 수행해야 합니다. 예를 들어, 보조 호스트에 대한 페일오버가 실행된 경우, 이전 운영 호스트의 백업도 모든 계층, CBA, ANF 볼륨 및 HANA 백업 카탈로그 내의 정의된 보존에 따라 삭제해야 합니다. 그렇지 않으면 로그 백업 보존 관리에 따라 이전 로그 백업을 삭제하면 이전 데이터 백업으로 인해 해당 백업이 차단됩니다.


CBA에서는 아래 그림과 같이 기본 및 보조 HANA 호스트인 두 HANA 호스트가 일반 HANA 시스템과 같이 구성됩니다. 구성 중 유일한 차이점은 이 HANA 시스템이 HSR의 일부임을 CBA에 알리기 위해 표시된 확인란입니다. CBA는 호스트에서 HSR 상태를 읽고 함께 속한 호스트와 운영 또는 보조 호스트를 확인할 수 있습니다. 내부적으로 CBA의 경우 이러한 두 호스트는 단일 엔터티로 취급되며, 여기서 백업은 현재 운영 호스트에 대해서만 실행되고 보존 관리는 두 호스트 모두에서 수행됩니다.


NOTE: CBA는 2개 호스트 구성에 대해서만 HSR을 지원합니다.

image:anf-cba-image104.png["이 그림에서는 CBA가 2개 호스트 구성에 대해서만 HSR을 지원하는 방법을 보여 줍니다."]



== 설치 및 구성 단계 개요

HSR 지원 HANA 시스템에 필요한 구성 단계에는 약간의 차이가 있습니다. 이 섹션에서는 이미 설명한 표준 구성 단계와 비교하여 차이점을 강조합니다.

. 기본 HSR 호스트의 HANA 시스템 데이터베이스에 백업 사용자를 생성합니다.
. 운영 호스트를 추가하고 Cloud Backup for Applications에서 HANA 시스템을 구성합니다.
+
.. 구성 중 * HANA 시스템 복제 * 를 선택합니다.
+
image:anf-cba-image105.png["완료 중인 단계의 스크린샷."]

.. 운영 호스트의 스토리지 설치 공간을 추가합니다.
+
image:anf-cba-image106.png["완료 중인 단계의 스크린샷."]



. 이제 새 HANA 시스템이 HSR 아이콘과 함께 나열됩니다.
+
image:anf-cba-image107.png["완료 중인 단계의 스크린샷."]

. 보조 호스트를 추가하고 Cloud Backup for Applications에서 HANA 시스템을 구성합니다.
+
.. 구성 중 * HANA 시스템 복제 * 를 선택합니다.
+
image:anf-cba-image108.png["완료 중인 단계의 스크린샷."]

.. 보조 호스트의 스토리지 설치 공간을 추가합니다.
+
image:anf-cba-image109.png["완료 중인 단계의 스크린샷."]

+
이제 두 시스템 모두 HSR 아이콘과 함께 나열됩니다.

+
image:anf-cba-image110.png["완료 중인 단계의 스크린샷."]



. 기본 및 보조 HANA 시스템에 백업 정책을 추가합니다.
+

NOTE: 두 HANA 호스트 모두에서 보존 관리가 수행되므로 두 시스템 모두에 동일한 정책을 추가해야 합니다.



이제 정의된 정책에 따라 백업이 실행됩니다. CBA는 항상 기본 HANA 호스트에서 스냅샷 백업 작업을 트리거합니다.

link:anf-cba-backup-operations-with-hana-multiple-host-systems.html["다음: HANA 다중 호스트 시스템을 사용한 백업 작업"]
