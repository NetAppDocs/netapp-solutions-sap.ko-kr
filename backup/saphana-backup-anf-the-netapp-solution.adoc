---
sidebar: sidebar 
permalink: backup/saphana-backup-anf-the-netapp-solution.html 
keywords: anf, snapshot, backup, copy, replication 
summary: Azure NetApp Files의 NetApp 스냅샷 기술을 사용하여 몇 초 내에 데이터베이스 백업을 생성할 수 있습니다. 스냅샷 복사본은 스토리지 플랫폼에서 물리적 데이터 블록을 이동하지 않으므로 스냅샷 복사본을 만드는 데 필요한 시간은 데이터베이스의 크기와 상관없습니다. 
---
= 제공하는 데 이 때 넷엡솔루션이 사용됩니다
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


link:saphana-backup-anf-overview.html["이전: 개요."]

Azure NetApp Files의 NetApp 스냅샷 기술을 사용하여 몇 초 내에 데이터베이스 백업을 생성할 수 있습니다. 스냅샷 복사본은 스토리지 플랫폼에서 물리적 데이터 블록을 이동하지 않으므로 스냅샷 복사본을 만드는 데 필요한 시간은 데이터베이스의 크기와 상관없습니다. 또한 스냅샷 기술을 사용해도 라이브 SAP 시스템의 성능에는 영향을 주지 않습니다. 따라서 최대 대화 상자나 일괄 작업 기간을 고려하지 않고 스냅샷 복사본 생성을 예약할 수 있습니다. Azure NetApp Files 기반 SAP 고객은 일반적으로 하루 동안 여러 온라인 스냅샷 백업을 예약합니다. 예를 들어, 4시간마다 일반적으로 됩니다. 이러한 스냅샷 백업은 일반적으로 운영 스토리지 시스템에서 제거되기 전에 3~5일 동안 보관됩니다.

Snapshot 복사본은 복원 및 복구 작업에 대한 주요 이점을 제공합니다. 볼륨 복원 작업을 사용하면 사용 가능한 스냅샷 복사본을 기반으로 전체 데이터베이스를 원하는 시점으로 복원할 수 있습니다. 이러한 복원 프로세스는 데이터베이스 크기와 관계없이 몇 초 내에 완료됩니다. 하루 동안 여러 개의 온라인 Snapshot 백업이 생성되므로 기존 백업 방식에 비해 복구 프로세스에 필요한 시간이 크게 단축됩니다. 복원 작업은 최대 24시간이 아닌 몇 시간 전의 스냅샷 복사본을 사용하여 수행할 수 있으므로 트랜잭션 로그를 적게 적용해야 합니다. 따라서 RTO는 기존의 단일 주기 백업에 필요한 몇 시간이 아니라 몇 분으로 줄어듭니다.

스냅샷 복사본 백업은 활성 온라인 데이터와 동일한 디스크 시스템에 저장됩니다. 따라서 2차 위치에 대한 백업을 대체하는 대신 스냅샷 복사본 백업을 보완 자료로 사용할 것을 권장합니다. 대부분의 복구 및 복구 작업은 기본 스토리지 시스템에서 볼륨 복원 작업을 사용하여 처리됩니다. 2차 위치에서의 복원은 스냅샷 복사본이 포함된 운영 스토리지 시스템이 손상된 경우에만 필요합니다. 스냅샷 복사본에서 더 이상 사용할 수 없는 백업을 복원해야 하는 경우 보조 위치를 사용할 수 있습니다.

추가 HANA 파일 기반 백업을 사용하여 보조 위치로 백업할 수 있습니다. 이러한 파일 기반 백업은 훨씬 적은 빈도로 예약할 수 있으므로 운영 시스템 성능에 미치는 영향을 최소화할 수 있습니다.

Azure NetApp Files 지역 간 복제를 재해 복구에 사용하면 모든 스냅샷 백업도 재해 복구 사이트에 복제되고 오프로드된 보조 백업으로도 사용할 수 있습니다. 도 참조하십시오 link:https://docs.netapp.com/us-en/netapp-solutions-sap/backup/saphana-dr-anf_data_protection_overview_overview.html["TR-4891: Azure NetApp Files를 사용한 SAP HANA 재해 복구"^].

또한 Azure AzCopy 도구를 사용하여 Azure Blob 저장소에 장기간 보존을 위한 스냅샷 복사본을 오프로드할 수 있습니다. 이를 위해서는 SnapCenter 서비스 외부의 추가 스크립팅이 필요합니다.

다음 그림에서는 스냅샷 백업 및 파일 기반 백업을 사용한 데이터 보호 구성의 예를 보여 줍니다.

image:saphana-backup-anf-image1.jpg["오류: 그래픽 이미지가 없습니다"]



== Snapshot 백업의 런타임

다음 그림은 NetApp 스토리지에 SAP HANA를 실행하는 고객의 HANA 스튜디오 스크린샷을 보여 줍니다. 고객이 NetApp Snapshot 복사본을 사용하여 HANA 데이터베이스를 백업하고 있습니다. 그림에서 알 수 있듯이 HANA 데이터베이스(약 2.3TB)는 Snapshot 백업 기술을 사용하여 2분 11초 내에 백업됩니다.

전체 백업 워크플로우 런타임의 가장 큰 부분은 HANA 백업 저장점 작업을 실행하는 데 필요한 시간입니다. 이 단계는 HANA 데이터베이스의 로드에 따라 달라집니다. 스토리지 스냅샷 백업 자체는 항상 몇 초 내에 완료됩니다.

image:saphana-backup-anf-image2.png["오류: 그래픽 이미지가 없습니다"]



== 복구 시간 목표 비교

이 섹션에서는 파일 기반 및 스토리지 기반 Snapshot 백업에 대한 RTO 비교에 대해 설명합니다. RTO는 데이터베이스를 복구하는 데 필요한 시간과 데이터베이스를 시작하고 복구하는 데 필요한 시간의 합으로 정의됩니다.



=== 데이터베이스를 복원하는 데 필요한 시간입니다

파일 기반 백업을 사용할 경우 복원 시간은 데이터베이스 및 백업 인프라의 크기에 따라 달라지며, 이 크기는 복원 속도(MB/sec)를 정의합니다. 예를 들어, 인프라에서 250MBps의 속도로 복원 작업을 지원하는 경우 데이터베이스 크기를 복원하는 데 약 1시간 10분이 소요됩니다.

스토리지 스냅샷 복사본 백업을 사용하면 복원 시간이 데이터베이스 크기와 상관없으며 몇 초 이내에 운영 스토리지에서 복원할 수 있습니다. 운영 스토리지를 더 이상 사용할 수 없는 경우 재해 발생 시에만 파일 기반 백업에서 복구할 수 있습니다.



=== 데이터베이스를 시작하는 데 필요한 시간입니다

데이터베이스 시작 시간은 행 및 열 저장소의 크기에 따라 달라집니다. 열 저장소의 경우 데이터베이스를 시작하는 동안 미리 로드된 데이터의 양에 따라 시작 시간도 달라집니다. 다음 예에서는 시작 시간이 30분이라고 가정합니다. 파일 기반 복원 및 복구와 스냅샷 복사본을 기반으로 하는 복원 및 복구의 시작 시간은 동일합니다.



=== 데이터베이스 복구에 필요한 시간

복구 시간은 복구 후 적용해야 하는 로그 수에 따라 달라집니다. 이 수는 데이터 백업을 수행하는 빈도에 따라 결정됩니다.

파일 기반 데이터 백업을 사용하면 백업 스케줄이 일반적으로 하루에 한 번 수행됩니다. 일반적으로 백업 빈도가 높으면 운영 성능이 저하되기 때문에 백업 빈도가 높을 수 없습니다. 따라서 최악의 경우, 하루 동안 기록된 모든 로그는 순방향 복구 중에 적용해야 합니다.

스토리지 스냅샷 복사본 데이터 백업은 SAP HANA 데이터베이스의 성능에 영향을 미치지 않으므로 일반적으로 더 자주 예약됩니다. 예를 들어, 스냅샷 복사본 백업을 6시간마다 예약하는 경우 복구 시간은 최악의 경우 파일 기반 백업을 위한 복구 시간의 1/4입니다(6시간/24시간 = 1/4).

다음 그림에서는 파일 기반 데이터 백업을 사용할 때 1TB 데이터베이스에 대한 RTO 예를 보여 줍니다. 이 예에서는 백업이 하루에 한 번 수행됩니다. RTO는 복원 및 복구를 수행한 시기에 따라 다릅니다. 백업을 수행한 직후 복원 및 복구를 수행한 경우 RTO는 주로 복원 시간(예: 1시간 10분)을 기준으로 합니다. 복구 및 복구가 수행된 후 다음 백업이 수행되기 바로 전에 2시간 50분으로 증가했으며 최대 RTO는 4시간 30분으로 증가했습니다.

image:saphana-backup-anf-image3.jpg["오류: 그래픽 이미지가 없습니다"]

다음 그림에서는 스냅샷 백업을 사용할 때의 1TB 데이터베이스에 대한 RTO 예를 보여 줍니다. 스토리지 기반 Snapshot 백업의 경우 RTO는 데이터베이스 크기와 관계없이 몇 초 내에 복원이 완료되므로 데이터베이스 시작 시간과 복구 전달 시간에 따라 달라집니다. 또한 복구 및 복구가 수행되는 시기에 따라 복구 시간이 증가하지만 백업 빈도가 높기 때문에(이 예에서는 6시간마다) 복구 전달 시간은 최대 43분입니다. 이 예에서 최대 RTO는 1시간 13분입니다.

image:saphana-backup-anf-image4.jpg["오류: 그래픽 이미지가 없습니다"]

다음 그림에서는 서로 다른 데이터베이스 크기와 서로 다른 Snapshot 백업 빈도에 대한 파일 기반 및 스토리지 기반 Snapshot 백업의 RTO 비교를 보여 줍니다. 녹색 막대는 파일 기반 백업을 보여줍니다. 다른 막대는 백업 빈도가 서로 다른 스냅샷 복사본 백업을 보여 줍니다.

Snapshot 복사본 데이터를 매일 단일 백업할 경우 파일 기반 데이터 백업에 비해 RTO가 40% 이미 줄어듭니다. 하루에 4개의 스냅샷 백업을 수행하면 이 감소율이 70%로 증가합니다. 또한 이 그림에서는 스냅샷 백업 빈도를 하루 4-6개 이상의 Snapshot 백업으로 늘릴 경우 곡선이 일정하다는 것을 보여 줍니다. 따라서 NetApp 고객은 일반적으로 하루에 4~6개의 스냅샷 백업을 구성합니다.

image:saphana-backup-anf-image5.jpg["오류: 그래픽 이미지가 없습니다"]

이 그래프는 HANA 서버 RAM 크기를 보여줍니다. 메모리의 데이터베이스 크기는 서버 RAM 크기의 절반으로 계산됩니다.

복원 및 복구 시간은 다음과 같은 가정을 기반으로 계산됩니다. 데이터베이스를 250MBps로 복원할 수 있습니다. 하루 로그 파일 수는 데이터베이스 크기의 50%입니다(예: 1TB 데이터베이스는 하루에 500MB의 로그 파일을 생성함). 또한 100Mbps로 복구를 수행할 수 있습니다.

link:saphana-backup-anf-snapcenter-service-architecture.html["다음: SnapCenter 서비스 아키텍처."]
