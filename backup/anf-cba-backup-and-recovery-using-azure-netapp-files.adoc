---
sidebar: sidebar 
permalink: backup/anf-cba-backup-and-recovery-using-azure-netapp-files.html 
keywords: runtime, backup, recovery, restore, recover 
summary: 'ANF(Azure NetApp Files) 스냅샷 기술을 사용하여 몇 초 내에 데이터베이스 백업을 생성할 수 있습니다. 스냅샷 복사본은 스토리지 플랫폼에서 물리적 데이터 블록을 이동하지 않으므로 스냅샷 복사본을 만드는 데 필요한 시간은 데이터베이스의 크기와 상관없습니다. 또한 스냅샷 기술을 사용해도 라이브 SAP 시스템의 성능에는 영향을 주지 않습니다.' 
---
= Azure NetApp Files를 사용한 백업 및 복구
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


link:anf-cba-overview.html["이전: 개요."]

[role="lead"]
ANF(Azure NetApp Files) 스냅샷 기술을 사용하여 몇 초 내에 데이터베이스 백업을 생성할 수 있습니다. 스냅샷 복사본은 스토리지 플랫폼에서 물리적 데이터 블록을 이동하지 않으므로 스냅샷 복사본을 만드는 데 필요한 시간은 데이터베이스의 크기와 상관없습니다. 또한 스냅샷 기술을 사용해도 라이브 SAP 시스템의 성능에는 영향을 주지 않습니다. 따라서 최대 대화 상자나 일괄 작업 기간을 고려하지 않고 스냅샷 복사본 생성을 예약할 수 있습니다. ANF 고객의 SAP는 일반적으로 하루 동안 여러 개의 온라인 스냅샷 백업을 예약합니다. 예를 들어, 일반적으로 4-6시간마다 백업을 예약합니다. 이러한 스냅샷 백업은 일반적으로 운영 스토리지 시스템에서 제거되기 전에 3~5일 동안 보관됩니다.

Snapshot 복사본은 복원 및 복구 작업에 대한 주요 이점을 제공합니다. 볼륨 복원 작업을 사용하면 사용 가능한 스냅샷 복사본을 기반으로 전체 데이터베이스를 원하는 시점으로 복원할 수 있습니다. 이러한 복원 프로세스는 데이터베이스 크기와 관계없이 몇 초 내에 완료됩니다. 하루 동안 여러 개의 온라인 Snapshot 백업이 생성되므로 기존 백업 방식에 비해 복구 프로세스에 필요한 시간이 크게 단축됩니다. 복원 작업은 최대 24시간이 아닌 몇 시간 전의 스냅샷 복사본을 사용하여 수행할 수 있으므로 트랜잭션 로그를 적게 적용해야 합니다. 따라서 RTO는 기존의 단일 주기 백업에 필요한 몇 시간이 아니라 몇 분으로 줄어듭니다.

스냅샷 복사본 백업은 활성 온라인 데이터와 동일한 디스크 시스템에 저장됩니다. 따라서 2차 위치에 대한 백업을 대체하는 대신 스냅샷 복사본 백업을 보완 자료로 사용할 것을 권장합니다. 대부분의 복구 및 복구 작업은 기본 스토리지 시스템에서 볼륨 복원 작업을 사용하여 처리됩니다. 2차 위치에서의 복원은 스냅샷 복사본이 포함된 운영 스토리지 시스템이 손상된 경우에만 필요합니다. 스냅샷 복사본에서 더 이상 사용할 수 없는 백업을 복원해야 하는 경우 보조 위치를 사용할 수 있습니다.

추가 HANA 파일 기반 백업을 사용하여 보조 위치로 백업할 수 있습니다. 이러한 파일 기반 백업은 훨씬 더 낮은 빈도로 예약할 수 있으므로 운영 시스템 성능에 미치는 영향이 적습니다.



== Snapshot 백업 및 복원 작업의 런타임

다음 그림에서는 스냅샷 백업 작업을 사용하는 고객의 HANA Studio를 보여 줍니다. 이 이미지는 스냅샷 백업 기술을 사용하여 HANA 데이터베이스(약 4TB의 크기)를 1분 20초 이내에 백업하고 파일 기반 백업 작업에서 4시간 이상을 백업한다는 것을 보여줍니다.

전체 백업 워크플로우 런타임의 가장 큰 부분은 HANA 백업 세이브 포인트 작업을 실행하는 데 필요한 시간이며, 이 단계는 HANA 데이터베이스의 로드에 따라 달라집니다. 스토리지 스냅샷 백업 자체는 항상 몇 초 내에 완료됩니다.

image:anf-cba-image1.png["이 그림에서는 스냅샷 백업 작업을 사용하는 고객의 HANA Studio를 보여 줍니다."]



== 복구 시간 목표 비교

이 섹션에서는 파일 기반 및 스토리지 기반 Snapshot 백업에 대한 RTO(복구 시간 목표) 비교를 제공합니다. RTO는 데이터베이스를 복원, 복구 및 시작하는 데 필요한 시간의 합계로 정의됩니다.



=== 데이터베이스를 복원하는 데 필요한 시간입니다

파일 기반 백업을 사용할 경우 복원 시간은 데이터베이스 및 백업 인프라의 크기에 따라 달라지며, 이 크기는 초당 메가바이트 단위로 복원 속도를 정의합니다. 예를 들어, 인프라에서 250MBps의 속도로 복원 작업을 지원하는 경우 지속성 상태에서 데이터베이스 크기가 4TB로 복원하는 데 약 4.5시간이 걸립니다.

스토리지 스냅샷 복사본 백업을 사용하면 복원 시간이 데이터베이스 크기와 상관없으며 항상 몇 초 내에 유지됩니다.



=== 데이터베이스를 시작하는 데 필요한 시간입니다

데이터베이스 시작 시간은 데이터베이스의 크기와 데이터를 메모리로 로드하는 데 필요한 시간에 따라 달라집니다. 다음 예에서는 데이터가 1000Mbps로 로드될 수 있다고 가정합니다. 4TB를 메모리에 로드하는 데 1시간 10분 정도 소요됩니다. 파일 기반 복구 및 스냅샷 기반 복원 및 복구 작업의 시작 시간은 동일합니다.


NOTE: Azure NetApp Files를 사용하면 볼륨 처리량을 동적으로 조정할 수 있습니다. HANA를 시작하기 전에 HANA 데이터 볼륨의 처리량을 늘리고 HANA 데이터베이스를 시작한 후 일상적인 운영 가치로 줄일 수 있습니다.



=== 데이터베이스 복구에 필요한 시간

복구 시간은 복구 후 적용해야 하는 로그 수에 따라 달라집니다. 이 수는 데이터 백업을 수행하는 빈도에 따라 결정됩니다.

파일 기반 데이터 백업을 사용하면 백업 스케줄이 일반적으로 하루에 한 번 수행됩니다. 백업이 운영 성능을 저하하므로 일반적으로 백업 빈도를 높일 수 없습니다. 따라서 최악의 경우, 하루 동안 기록된 모든 로그는 순방향 복구 중에 적용해야 합니다.

스냅샷 백업은 SAP HANA 데이터베이스의 성능에 영향을 주지 않으므로 일반적으로 더 자주 스케줄됩니다. 예를 들어 스냅샷 백업을 6시간마다 예약할 경우 최악의 경우 파일 기반 백업의 복구 시간의 4분의 1이 복구 시간으로 계산됩니다(6시간/24시간 = 0.25).

다음 그림에서는 다양한 스케줄을 사용하는 일일 파일 기반 백업 및 스냅샷 백업과 복구 작업을 비교하여 보여 줍니다.

처음 두 개의 막대는 매일 단일 Snapshot 백업을 하더라도 스냅샷 백업의 복원 작업 속도로 인해 복원 및 복구가 43%로 줄어들었다는 것을 보여줍니다. 하루에 여러 개의 Snapshot 백업이 생성되는 경우 앞으로 복구 중에 적용해야 할 로그 수가 적기 때문에 실행 시간이 더 단축될 수 있습니다.

다음 그림에서는 하루 4~6개의 Snapshot 백업이 가장 적합하다는 것을 보여 줍니다. 이보다 더 높은 빈도는 전체 런타임에 큰 영향을 주지 않기 때문입니다.

image:anf-cba-image2.png["이 그림에서는 다양한 스케줄을 가진 일일 파일 기반 백업 및 스냅샷 백업과 복구 작업을 비교하여 보여 줍니다."]

link:anf-cba-use-cases-and-value-of-accelerated-backup-and-cloning-operations_overview.html["다음으로 백업 및 클로닝 작업 가속의 활용 사례와 가치를 살펴보겠습니다."]
